import{g as _}from"./index-cc592f13.js";import{V as k}from"./index-9fa65e42.js";import"./index-7b16d8bf.js";function z(n){if(n)throw n}var m=Object.prototype.hasOwnProperty,F=Object.prototype.toString,A=Object.defineProperty,I=Object.getOwnPropertyDescriptor,T=function(e){return typeof Array.isArray=="function"?Array.isArray(e):F.call(e)==="[object Array]"},C=function(e){if(!e||F.call(e)!=="[object Object]")return!1;var t=m.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&m.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!r)return!1;var s;for(s in e);return typeof s>"u"||m.call(e,s)},S=function(e,t){A&&t.name==="__proto__"?A(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},j=function(e,t){if(t==="__proto__")if(m.call(e,t)){if(I)return I(e,t).value}else return;return e[t]},L=function n(){var e,t,r,s,a,c,o=arguments[0],u=1,i=arguments.length,f=!1;for(typeof o=="boolean"&&(f=o,o=arguments[1]||{},u=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});u<i;++u)if(e=arguments[u],e!=null)for(t in e)r=j(o,t),s=j(e,t),o!==s&&(f&&s&&(C(s)||(a=T(s)))?(a?(a=!1,c=r&&T(r)?r:[]):c=r&&C(r)?r:{},S(o,{name:t,newValue:n(f,c,s)})):typeof s<"u"&&S(o,{name:t,newValue:s}));return o};const w=_(L);function x(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function N(){const n=[],e={run:t,use:r};return e;function t(...s){let a=-1;const c=s.pop();if(typeof c!="function")throw new TypeError("Expected function as last argument, not "+c);o(null,...s);function o(u,...i){const f=n[++a];let l=-1;if(u){c(u);return}for(;++l<s.length;)(i[l]===null||i[l]===void 0)&&(i[l]=s[l]);s=i,f?U(f,o)(...i):c(null,...i)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return n.push(s),e}}function U(n,e){let t;return r;function r(...c){const o=n.length>c.length;let u;o&&c.push(s);try{u=n.apply(this,c)}catch(i){const f=i;if(o&&t)throw f;return s(f)}o||(u&&u.then&&typeof u.then=="function"?u.then(a,s):u instanceof Error?s(u):a(u))}function s(c,...o){t||(t=!0,e(c,...o))}function a(c){s(null,c)}}const B=function(n){const r=this.constructor.prototype,s=r[n],a=function(){return s.apply(a,arguments)};return Object.setPrototypeOf(a,r),a},$={}.hasOwnProperty;class O extends B{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=N()}copy(){const e=new O;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];e.use(...r)}return e.data(w(!0,{},this.namespace)),e}data(e,t){return typeof e=="string"?arguments.length===2?(P("data",this.frozen),this.namespace[e]=t,this):$.call(this.namespace,e)&&this.namespace[e]||void 0:e?(P("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=t.call(e,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=d(e),r=this.parser||this.Parser;return g("parse",r),r(String(t),t)}process(e,t){const r=this;return this.freeze(),g("process",this.parser||this.Parser),b("process",this.compiler||this.Compiler),t?s(void 0,t):new Promise(s);function s(a,c){const o=d(e),u=r.parse(o);r.run(u,o,function(f,l,p){if(f||!l||!p)return i(f);const h=l,y=r.stringify(h,p);Y(y)?p.value=y:p.result=y,i(f,p)});function i(f,l){f||!l?c(f):a?a(l):t(void 0,l)}}}processSync(e){let t=!1,r;return this.freeze(),g("processSync",this.parser||this.Parser),b("processSync",this.compiler||this.Compiler),this.process(e,s),D("processSync","process",t),r;function s(a,c){t=!0,z(a),r=c}}run(e,t,r){V(e),this.freeze();const s=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?a(void 0,r):new Promise(a);function a(c,o){const u=d(t);s.run(e,u,i);function i(f,l,p){const h=l||e;f?o(f):c?c(h):r(void 0,h,p)}}}runSync(e,t){let r=!1,s;return this.run(e,t,a),D("runSync","run",r),s;function a(c,o){z(c),s=o,r=!0}}stringify(e,t){this.freeze();const r=d(t),s=this.compiler||this.Compiler;return b("stringify",s),V(e),s(e,r)}use(e,...t){const r=this.attachers,s=this.namespace;if(P("use",this.frozen),e!=null)if(typeof e=="function")u(e,t);else if(typeof e=="object")Array.isArray(e)?o(e):c(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function a(i){if(typeof i=="function")u(i,[]);else if(typeof i=="object")if(Array.isArray(i)){const[f,...l]=i;u(f,l)}else c(i);else throw new TypeError("Expected usable value, not `"+i+"`")}function c(i){if(!("plugins"in i)&&!("settings"in i))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(i.plugins),i.settings&&(s.settings=w(!0,s.settings,i.settings))}function o(i){let f=-1;if(i!=null)if(Array.isArray(i))for(;++f<i.length;){const l=i[f];a(l)}else throw new TypeError("Expected a list of plugins, not `"+i+"`")}function u(i,f){let l=-1,p=-1;for(;++l<r.length;)if(r[l][0]===i){p=l;break}if(p===-1)r.push([i,...f]);else if(f.length>0){let[h,...y]=f;const E=r[p][1];x(E)&&x(h)&&(h=w(!0,E,h)),r[p]=[i,h,...y]}}}}const K=new O().freeze();function g(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function b(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function P(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function V(n){if(!x(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function D(n,e,t){if(!t)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function d(n){return R(n)?n:new k(n)}function R(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function Y(n){return typeof n=="string"||q(n)}function q(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}export{K as unified};
//# sourceMappingURL=index-4afb3d95.js.map
