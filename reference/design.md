📌 文档结构化组件功能清单（面向前端开发）

# 产品背景说明：
用于指导结构化文档编辑器、协同编辑系统的前端模块开发。

## 1. 文档内容结构化（Content Structuring）

### 1.1 模板与控件
- [ ] 模板库管理（模板创建/加载/保存）
- [ ] 字段控件支持：
  - [ ] 文本输入框（TextInput）
  - [ ] 数字输入框（NumberInput）
  - [ ] 日期选择器（DatePicker）
  - [ ] 下拉菜单（Dropdown）
  - [ ] 复选框（Checkbox）
  - [ ] 附件上传控件（FileUploader）
- [ ] 自定义字段（支持字段命名、字段类型自定义）

### 1.2 表格与嵌件
- [ ] 内嵌表格组件（类 Excel）
- [ ] 表格公式支持（Sum、Avg 等）
- [ ] 图表嵌入（柱状图、折线图）
- [ ] 流程图、公式（MathJax/LaTeX）插件支持

### 1.3 块级结构编辑（Block-Based Editing）
- [ ] 区块创建/拖拽/聚合
- [ ] 命名块支持（Named Block）
- [ ] 同名块复用机制

## 2. 协同编辑与权限控制（Collaboration & Permissions）

### 2.1 实时协同编辑
- [ ] 多人编辑同步
- [ ] 段落级锁定机制
- [ ] 编辑冲突提示与合并建议

### 2.2 评论与审批
- [ ] 块级评论
- [ ] @用户通知机制
- [ ] 审批流程引擎（节点定义 + 审批流转）

### 2.3 权限管理
- [ ] 文档级权限（查看/编辑/评论/审批）
- [ ] 区块级权限设置（是否可见、可编辑）

## 3. 文档引用与知识关系（Linking & Knowledge）

### 3.1 引用机制
- [ ] 块级引用插入
- [ ] 自动建立双向链接
- [ ] 引用卡片 hover 展示源内容摘要

### 3.2 关系可视化
- [ ] 引用关系图谱组件（基于 DAG / force layout）
- [ ] 支持点击跳转引用源

### 3.3 标签化与搜索
- [ ] 标签系统（文档 + 区块）
- [ ] 全文检索（含字段、标签）
- [ ] 聚合搜索筛选组件（标签、时间、作者）

## 4. 版本与变更管理（Versioning & Change Logs）

### 4.1 自动版本控制
- [ ] 每次提交自动生成版本快照
- [ ] 历史版本浏览与对比
- [ ] 一键回滚按钮

### 4.2 引用同步机制
- [ ] 源引用变更提示
- [ ] 差异比对视图（diff）
- [ ] 同步/忽略选项

### 4.3 改动轨迹追踪
- [ ] 支持按用户、时间、段落筛选改动内容

## 5. 内容校核与一致性验证（Validation）

### 5.1 信息抽取
- [ ] 自动识别字段（如金额、时间、单位等）
- [ ] 高亮提醒填写不规范项

### 5.2 冲突检测
- [ ] 提交前检测多用户改动冲突
- [ ] 冲突标注与修复建议

### 5.3 一致性校验
- [ ] 引用内容的结构/命名对比
- [ ] 校核触发器（Before Submit Hook）

## 6. 第三方集成与扩展能力（Integration）

### 6.1 API 支持
- [ ] REST API 接口（文档增删改查）
- [ ] GraphQL Schema（选配）
- [ ] Webhook 消息回调（引用更新、审批通过）

### 6.2 插件扩展机制
- [ ] 插件管理入口
- [ ] 插件加载机制（支持 Chart、流程图、公式等）

### 6.3 认证与登录
- [ ] SSO 支持（OAuth2、SAML）
- [ ] 二次认证（2FA 短信/邮箱）

## 7. 安全与合规性（Security & Compliance）

- [ ] 用户行为日志（查看、修改、审批等）
- [ ] 审计导出功能（PDF/JSON 格式）
- [ ] 多租户逻辑隔离（文档不可跨团队共享）

## 8. 用户体验与辅助功能（UX）

- [ ] 响应式布局（桌面、移动端）
- [ ] 智能提示（字段推荐、模板推荐）
- [ ] 支持导入导出格式：DOCX / PDF / HTML / Markdown
- [ ] 离线编辑支持（本地缓存 + 自动同步）

## 9. 特殊机制与流程引擎（Workflow）

| 功能 | 实现方式说明 |
|------|--------------|
| 段落级锁定 | 进入编辑时自动锁定段落、编辑完释放 |
| 引用同步机制 | 源变更自动标记差异，引用方可点击同步 |
| 校验触发器 | 提交按钮绑定校验流程 |
| 审批流程引擎 | 节点配置器 + 状态流转图组件 |

# 🧩 产品功能模块一览（前端组件拆解）

> 下述模块按照「功能颗粒」进行划分，具备清晰组件边界，方便开发与复用。适用于 React + Vite 前端项目结构设计。

---

## 1️⃣ 编辑器模块（BlockEditor）

### 🔹 核心组件

| 组件名 | 说明 |
|--------|------|
| `BlockEditor` | 核心容器，支持块插入、拖拽、引用等 |
| `TextBlock` | 普通段落，支持文本编辑 |
| `FieldBlock` | 结构化控件块（字段输入，如下拉、数字等） |
| `TableBlock` | 简化表格块，类 Notion Table，可插入数据 |
| `ReferenceBlock` | 引用其他块的引用视图（Hover 可展开） |
| `BlockToolbar` | 每个块 Hover 时出现的浮动菜单（复制、删除、插入引用等） |

### 🔹 交互支持
- 拖拽块排序（React DnD）
- 右键菜单 / 悬浮菜单支持
- Markdown 快捷输入（如 `#` 为标题、`/table` 插入表格）

---

## 2️⃣ 模板与结构化控件（TemplateCenter）

### 🔹 模板库界面
- 左侧模板列表，右侧预览和使用按钮
- 模板格式为 JSON（定义字段/块布局）
- 一键插入文档初始内容

### 🔹 字段控件支持（FieldBlock）
- 文本框 / 数字框
- 日期选择器
- 下拉菜单
- 复选框
- 文件上传（展示文件名即可）

---

## 3️⃣ 引用与同步机制（ReferenceSystem）

### 🔹 引用机制
- 插入引用按钮：打开弹窗，搜索可引用块
- 引用块为只读状态，展示“来源文档/块名称”
- 模拟“源块更新 → 引用块提示更新”

### 🔹 双向跳转
- 点击引用卡片跳转源块
- 支持 hover 展示引用摘要

---

## 4️⃣ 评论与审批流程（CommentAndApproval）

### 🔹 评论
- 块级悬浮评论图标
- 弹窗形式评论框（支持 @人）
- 支持基本评论查看、删除、标记已处理

### 🔹 审批流程（简化版）
- 流程节点图（固定流程即可）
- 每个节点显示状态（未审批/已通过/驳回）
- 审批按钮 + 状态反馈提示

---

## 5️⃣ 版本与变更视图（VersionPanel）

### 🔹 版本模拟
- 顶部“保存版本”按钮
- 展示最近版本快照（版本列表 + 时间）
- 简化版差异对比（高亮新增、修改块）

---

## 6️⃣ 搜索与引用图谱（SearchAndGraph）

### 🔹 搜索支持
- 文档结构搜索（标题/块关键词）
- 支持字段值筛选（如“所有状态为待审批”）

### 🔹 引用关系图谱
- 使用 Vis.js 或 AntV X6 实现关系视图
- 点选节点高亮引用关系

---

## 🔐 权限与状态模拟（前端伪数据）

- 以“单用户”身份模拟多角色视角
- 控制可编辑区块与不可编辑区块（锁定状态）
- 状态标签（如“审批中”、“已引用”）展示在块右上角

---

## 📂 推荐目录结构（适用于 React + Vite 项目）

\`\`\`bash
src/
├── components/
│   ├── BlockEditor/
│   │   ├── BlockEditor.jsx
│   │   ├── TextBlock.jsx
│   │   ├── FieldBlock.jsx
│   │   ├── TableBlock.jsx
│   │   └── ReferenceBlock.jsx
│   ├── TemplateCenter/
│   ├── VersionPanel/
│   ├── ApprovalPanel/
│   └── GraphViewer/
├── pages/
│   └── EditorDemo.jsx
├── assets/
│   └── icons/
├── styles/
├── utils/
│   └── mockData.js
├── App.jsx
└── main.jsx
\`\`\`
